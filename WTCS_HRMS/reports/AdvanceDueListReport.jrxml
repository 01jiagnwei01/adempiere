<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: AdvanceDueListReport.jrxml 1009 2012-02-09 09:16:13Z suman $ --> 
 <jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="AdvanceDueListReport" printOrder="Horizontal" pageWidth="800" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="740" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<parameter name="FromDate" class="java.sql.Timestamp"/>
	<parameter name="ToDate" class="java.sql.Timestamp">
		<defaultValueExpression><![CDATA[$P{FromDate}]]></defaultValueExpression>
	</parameter>
	<parameter name="C_BPartner_ID" class="java.math.BigDecimal">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA[new BigDecimal(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="HR_Employee_Type_ID" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[new BigDecimal(0)]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["./"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT distinct COALESCE(cb.employee_code,'') as employeeNumber ,
       COALESCE(cb.name,'') as employeeName,
       (SELECT   COALESCE((sum(COALESCE(approvedamt,0)-COALESCE(advancereturnamt,0))),0)
          FROM HR_Sal_Adv_Req adreq1

         WHERE adreq1.advancegivendate<'$P!{FromDate}'
         AND adreq1.c_bpartner_id=salreq.C_BPartner_ID
         AND adreq1.approvedamt != adreq1.advancereturnamt
       ) as openBalence,
       (SELECT   COALESCE((sum(COALESCE(approvedamt,0))),0)
         FROM HR_Sal_Adv_Req adreq2
         WHERE adreq2.advancegivendate>='$P!{FromDate}'
         and adreq2.advancegivendate<='$P!{ToDate}'
         and adreq2.c_bpartner_id=salreq.C_BPartner_ID
         AND adreq2.approvedamt != adreq2.advancereturnamt
       ) as advancePaid ,
       (SELECT   COALESCE((sum(COALESCE(advancereturnamt,0))),0)
         FROM HR_Sal_Adv_Req adreq3
         WHERE adreq3.advancegivendate>='$P!{FromDate}'
         and adreq3.advancegivendate<='$P!{ToDate}'
         and adreq3.c_bpartner_id=salreq.C_BPartner_ID
         AND adreq3.approvedamt != adreq3.advancereturnamt
       ) as advanceRePaid
FROM hr_sal_adv_req  salreq
JOIN C_BPartner cb ON cb.c_bpartner_id=salreq.c_bpartner_id
WHERE (  CASE WHEN $P{C_BPartner_ID} = 0  THEN  1=1  ELSE salreq.C_BPartner_ID=$P{C_BPartner_ID} END   )
       AND
       ( case when $P{HR_Employee_Type_ID} = 0
        then
             1 = 1
          else
             cb.hr_employee_type_id=$P{HR_Employee_Type_ID}
        end )]]>
	</queryString>
	<field name="employeeNumber" class="java.lang.String"/>
	<field name="employeeName" class="java.lang.String"/>
	<field name="openBalence" class="java.math.BigDecimal"/>
	<field name="advancePaid" class="java.math.BigDecimal"/>
	<field name="advanceRePaid" class="java.math.BigDecimal"/>
	<variable name="GivenAmount" class="java.math.BigDecimal" resetType="None">
		<variableExpression><![CDATA[$F{openBalence}.add( $F{advancePaid} )]]></variableExpression>
	</variable>
	<variable name="DueAmount" class="java.math.BigDecimal" resetType="None">
		<variableExpression><![CDATA[$F{advancePaid}.subtract( $F{advanceRePaid} )]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="41" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-8" x="212" y="23" width="341" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="14" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Advance Due List Report]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="25" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-1" x="1" y="7" width="145" height="18"/>
				<textElement>
					<font size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Due List From Date]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="261" y="7" width="51" height="18"/>
				<textElement>
					<font size="10" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[To Date]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="false">
				<reportElement key="textField" x="146" y="7" width="95" height="18"/>
				<textElement/>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$P{FromDate}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="false">
				<reportElement key="textField" x="312" y="7" width="115" height="18"/>
				<textElement/>
				<textFieldExpression class="java.sql.Timestamp"><![CDATA[$P{ToDate}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="30" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-4" x="1" y="8" width="67" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[SI No.]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-5" x="68" y="8" width="106" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[Emp ID.]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-6" x="174" y="8" width="195" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[      EMPLOYEE NAME]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-11" x="369" y="8" width="100" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[ADVANCE GIVEN]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-12" x="469" y="8" width="106" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[ADVANCE PAID]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-13" x="575" y="8" width="87" height="22"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[BALANCE DUE]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="24" splitType="Stretch">
			<rectangle>
				<reportElement key="rectangle-1" x="1" y="0" width="67" height="24"/>
			</rectangle>
			<textField isBlankWhenNull="false">
				<reportElement key="textField" x="14" y="4" width="40" height="18"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{REPORT_COUNT}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement key="textField" x="68" y="0" width="106" height="24"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{employeeNumber}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement key="textField" x="174" y="0" width="195" height="24"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{employeeName}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="false">
				<reportElement key="textField" x="469" y="0" width="106" height="24"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{advanceRePaid}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="##0.00" isBlankWhenNull="false">
				<reportElement key="textField" x="575" y="0" width="87" height="24"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{DueAmount}]]></textFieldExpression>
			</textField>
			<textField pattern="##0.00" isBlankWhenNull="false">
				<reportElement key="textField" x="369" y="0" width="100" height="24"/>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid"/>
					<leftPen lineWidth="1.0" lineStyle="Solid"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid"/>
					<rightPen lineWidth="1.0" lineStyle="Solid"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{advancePaid}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="2" splitType="Stretch"/>
	</summary>
	<noData>
		<band height="40" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-9" x="152" y="15" width="401" height="22"/>
				<textElement textAlignment="Center">
					<font size="14" isBold="true" pdfFontName="Helvetica-Bold"/>
				</textElement>
				<text><![CDATA[No  Data Found For The Given Input Combination]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
