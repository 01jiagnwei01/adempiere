<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: PaySlipSubreportLeave.jrxml 1009 2012-02-09 09:16:13Z suman $ --> 
 <jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="PaySlipSubreportLeave" pageWidth="535" pageHeight="802" columnWidth="535" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<subDataset name="attendence">
		<queryString>
			<![CDATA[SELECT cct.name AS CategoryName,cc.name AS ConceptName,hrm.qty,hrm.HR_Process_ID
FROM HR_Movement hrm
JOIN HR_Concept_Category cc ON (cc.HR_Concept_Category_ID = hrm.HR_Concept_Category_ID)
JOIN HR_Concept cct ON (cct.HR_Concept_ID = hrm.HR_Concept_ID)
WHERE hrm.C_BPartner_ID=1000030 AND hrm.HR_PRocess_ID=1000009 AND
(hrm.HR_Concept_Category_ID =(SELECT HR_Concept_Category_ID FROM HR_Concept_Category hrcc WHERE hrcc.name='Attendence' ))
AND (hrm.HR_Concept_ID IN (SELECT HR_Concept_ID FROM HR_Concept hrc WHERE hrc.name='Working Days' OR
hrc.name='Absent Days' OR hrc.name='Weekly off' OR  hrc.name='Present Days' OR
  hrc.name='Late Comming'))]]>
		</queryString>
		<field name="categoryname" class="java.lang.String"/>
		<field name="conceptname" class="java.lang.String"/>
		<field name="qty" class="java.math.BigDecimal"/>
		<field name="hr_process_id" class="java.math.BigDecimal"/>
	</subDataset>
	<parameter name="C_BPartner_ID" class="java.math.BigDecimal"/>
	<queryString>
		<![CDATA[SELECT
lt.hr_leavetype_id,lt.leavetype,
round(coalesce(hla.used_leaves,0),1) as used,
round(coalesce(hla.balance_leaves,0),1) as balance
FROM hr_leave_assign hla
 JOIN hr_leavetype lt
 ON lt.hr_leavetype_id = hla.hr_leavetype_id
  WHERE
  hla.c_bpartner_id = $P{C_BPartner_ID}  AND
  hla.isactive = 'Y'
  AND lt.isactive = 'Y']]>
	</queryString>
	<field name="hr_leavetype_id" class="java.math.BigDecimal"/>
	<field name="leavetype" class="java.lang.String"/>
	<field name="used" class="java.math.BigDecimal"/>
	<field name="balance" class="java.math.BigDecimal"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="15" splitType="Stretch">
			<staticText>
				<reportElement key="staticText-1" x="18" y="2" width="252" height="11"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="8" isBold="true" isItalic="true" isUnderline="false" pdfFontName="Helvetica-BoldOblique"/>
				</textElement>
				<text><![CDATA[Leave Summary]]></text>
			</staticText>
			<line>
				<reportElement key="line-1" x="18" y="13" width="252" height="1"/>
			</line>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="19" splitType="Stretch">
			<staticText>
				<reportElement x="18" y="1" width="96" height="16"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Leave Type]]></text>
			</staticText>
			<staticText>
				<reportElement x="132" y="1" width="60" height="16"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Consumed]]></text>
			</staticText>
			<staticText>
				<reportElement x="210" y="1" width="60" height="16"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Available]]></text>
			</staticText>
			<line>
				<reportElement key="line-1" x="18" y="18" width="252" height="1"/>
			</line>
		</band>
	</columnHeader>
	<detail>
		<band height="18" splitType="Stretch">
			<textField>
				<reportElement x="18" y="0" width="96" height="18"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{leavetype}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="132" y="0" width="60" height="18"/>
				<textElement/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{used}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="210" y="0" width="60" height="18">
					<printWhenExpression><![CDATA[$F{hr_leavetype_id}.intValue()!=1000002]]></printWhenExpression>
				</reportElement>
				<textElement/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{balance}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
